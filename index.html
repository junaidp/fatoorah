<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
    <link href="css/style.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css" rel="stylesheet">
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/jquery.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-route.js"></script>


    <link type="text/css" rel="stylesheet" href="/css/responsive-tabs.css" />
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <script src="js/jquery-2.1.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
    <script src="js/jquery.js"></script>
    <script src="js/jquery.responsiveTabs.js" type="text/javascript"></script>


    <script>
        (function() {
            var basePath = "https://c5e7-2a0a-a541-4e1c-0-1d7d-997a-321e-c188.ngrok.io/";


            var app = angular.module("myApp", ["ngRoute"]);
            //Configuration
            app.config(function($routeProvider) {
                $routeProvider
                    .when("/", {
                        templateUrl: "main.html"
                    })
                    .when("/login", {
                        templateUrl: "./loginform/index.html"
                    })
                    .when("/customer", {
                        templateUrl: "customer.html"
                    })
                    .when("/addcustomer", {
                        templateUrl: "addcustomer.html"
                    })
                    .when("/main", {
                        templateUrl: "main.html"
                    })
                    .when("/invoice", {
                        templateUrl: "invoice.html"
                    }).
                when("/createinvoice", {
                        templateUrl: "createinvoice.html"
                    })
                    .when("/products", {
                        templateUrl: "product.html"
                    })
                    .when("/addproduct", {
                        templateUrl: "addproduct.html"
                    })
                    .when("/setting", {
                        templateUrl: "setting.html"
                    })
                    .when("/edituserprofile", {
                        templateUrl: "edituserprofile.html"
                    })
                    .when("/usermanagement", {
                        templateUrl: "usermanagement.html"
                    })
                    .when("/chartofaccount", {
                        templateUrl: "chartofaccount.html"
                    })
                    .when("/printinvoice", {
                        templateUrl: "printinvoice.html"
                    })
                    .when("/report", {
                        templateUrl: "report.html"
                    })
                    .when("/incomebycustomer", {
                        templateUrl: "incomebycustomer.html"
                    })
                    .when("/incomebyproduct", {
                        templateUrl: "incomebyproduct.html"
                    })
                    .when("/incomebyperiod", {
                        templateUrl: "incomebyperiod.html"
                    })
                    .otherwise({
                        redirectTo: "/main"
                    });
            });


            //Customer Controller
            app.controller("customerController", function($scope, $http) {
                $http.get(basePath + "control/getAllCustomers?companyID=1")
                    .then(function(response) {
                        debugger
                        $scope.customers = response.data;
                    });
            });

            //Add Customer

            app.controller("customerCtrl", function($scope, $http, $window) {


                $scope.customerName = null;
                $scope.firstName = null;
                $scope.lastName = null;
                $scope.accountNumber = null;
                $scope.website = null;
                $scope.notes = null;
                $scope.currency = null;
                $scope.billingCountry = null;

                $scope.billingProvince = null;
                $scope.billingCity = null;
                $scope.billingPostal = null;
                $scope.shippingName = null;
                $scope.shippingAddress = null;

                $scope.shippingCity = null;
                $scope.shippingAddress2 = null;
                $scope.shippingCity = null;
                $scope.shippingProvince = null;
                $scope.shippingPostal = null;
                $scope.phone = null;
                $scope.deliveryInstructions = null;

                $scope.SaveCustomer = function() {
                    var data = {
                        customer: $scope.customerName,
                        firstName: $scope.firstName,
                        LastName: $scope.lastName,
                        accountNumber: $scope.accountNumber,
                        website: $scope.website,
                        notes: $scope.notes,
                        currency: $scope.currency,
                        billingCountry: $scope.billingCountry,
                        billingProvince: $scope.billingProvince,
                        billingCity: $scope.billingCity,
                        billingPostal: $scope.billingPostal,
                        shippingName: $scope.shippingName,
                        shippingAddress: $scope.shippingAddress,
                        shippingCountry: $scope.shippingCity,
                        shippingAddress2: $scope.shippingAddress2,
                        shippingCity: $scope.shippingCity,
                        shippingProvince: $scope.shippingProvince,
                        shippingPostal: $scope.shippingPostal,
                        phone: $scope.phone,
                        deliveryInstructions: $scope.deliveryInstructions,
                        userId: 1,
                        companyID: "1",
                    };


                    $http.post(basePath + 'control/saveCustomer', JSON.stringify(data)).then(function(response) {}, function(response) {
                        alert("Customer Saved successfully...!")
                    });
                };
            });

            //Product Controler
            app.controller("productController", function($scope, $http) {
                $http.get(basePath + "control/getProductsMain?companyId=1")
                    .then(function(response) {
                        $scope.products = response.data;
                    });
            });
            //Setting Controller
            app.controller("settingCtrl", function($scope, $http) {

                $scope.location = null;
                $scope.vat = null;
                //GET All Locations
                $http.get(basePath + "control/getAllLocations")
                    .then(function(response) {
                        $scope.locations = response.data;
                    });

                //GET ALL VATS
                $http.get(basePath + "control/getAllVats?companyID=1")
                    .then(function(response) {
                        $scope.vates = response.data;
                    });
                //Save location
                $scope.saveAllLocation = function() {
                    var data = {
                        locationName: $scope.location
                    };
                    $http.post(basePath + 'control/saveLocation', JSON.stringify(data)).then(function(response) {}, function(response) {
                        alert("Location Saved successfully...!")
                    });
                };
                //Save VAT
                $scope.SaveVAT = function() {
                    var data = {
                        vatRates: $scope.vatName,
                        companyID: "1"
                    };
                    debugger;
                    $http.post(basePath + 'control/saveVat', JSON.stringify(data)).then(function(response) {}, function(response) {
                        alert("VAT Saved successfully...!")
                    });
                };



            });

            //Get Chart of Account 

            app.controller("chartOfAccountController", function($scope, $http) {
                $scope.code = null;
                $scope.name = null;
                $scope.accountType = null;

                $http.get(basePath + "control/getAccounts?accountType=Revenue&companyID=1")
                    .then(function(response) {
                        $scope.RevenueAccount = response.data;
                    });

                $http.get(basePath + "control/getAccounts?accountType=BankAccount&companyID=1")
                    .then(function(response) {
                        $scope.BankAccount = response.data;
                    });

                $scope.SaveAccount = function() {
                    debugger;
                    var accData = {
                        code: $scope.code,
                        name: $scope.name,
                        accountType: $scope.accountType,
                        companyID: "1"
                    };

                    debugger;
                    $http.post(basePath + 'control/saveAccounts', JSON.stringify(accData)).then(function(response) {}, function(response) {
                        alert("Account Saved successfully...!")
                    });
                };


                //
            });
            //Edit Profile
            app.controller("userProileCtrl", function($scope, $http) {

                $scope.companyName = null;
                $scope.email = null;
                $scope.password = null;
                $scope.address1 = null;
                $scope.address2 = null;
                $scope.cellNo = null;
                $scope.notes = null;
                $scope.website = null;

                $scope.currency = null;
                $scope.country = null;
                $scope.state = null;
                $scope.city = null;
                $scope.postalCode = null;
                $scope.userType = null;

                $scope.postdata = function() {
                    var data = {
                        companyName: $scope.companyName,
                        email: $scope.email,
                        password: $scope.password,
                        address1: $scope.address1,
                        address2: $scope.address2,
                        cellNo: $scope.cellNo,
                        notes: $scope.notes,
                        website: $scope.website,
                        currency: $scope.currency,
                        country: $scope.country,
                        state: $scope.state,
                        city: $scope.city,
                        postalCode: $scope.postalCode,
                        userType: $scope.userType
                    };


                    $http.post(basePath + 'control/saveCompany', JSON.stringify(data)).then(function(response) {}, function(response) {
                        alert("Company Saved successfully...!")
                    });
                };
            });

            //User management Controller

            app.controller("userCtrl", function($scope, $http) {


                $scope.username = null;
                $scope.email = null;
                $scope.password = "National$0";
                $scope.location = null;
                $scope.companyID = "1";
                $scope.listRoles = [];

                $scope.saveUser = function() {
                    debugger;
                    if ($('#productsetup:checkbox:checked').length > 0) {
                        $scope.listRoles.push("productsetup");
                    }
                    if ($('#Invoiceraise:checkbox:checked').length > 0) {
                        $scope.listRoles.push("Invoiceraise");
                    }
                    if ($('#Paymentreceipt:checkbox:checked').length > 0) {
                        $scope.listRoles.push("Paymentreceipt");
                    }
                    if ($('#Approve:checkbox:checked').length > 0) {
                        $scope.listRoles.push("Approve");
                    }

                    var data = {
                        name: $scope.userName,
                        email: $scope.email,
                        password: $scope.password,
                        role: "admin",
                        location: $scope.location,
                        companyID: $scope.comapnyID,
                        listRoles: $scope.listRoles
                    };


                    $http.post(basePath + 'control/saveUser', JSON.stringify(data)).then(function(response) {}, function(response) {
                        alert("User Saved successfully...!")
                    });
                };


                $http.get(basePath + "control/getAllLocations")
                    .then(function(response) {
                        debugger
                        $scope.locations = response.data;
                    });
            });

            //Create Invoice 

            app.controller("createInvoiceCtrl", function($scope, $http) {

                $http.get(basePath + "control/getAllCustomers?companyID=1")
                    .then(function(response) {
                        debugger
                        $scope.customers = response.data;
                    });

                $http.get(basePath + "control/getAllVats?companyID=1")
                    .then(function(response) {
                        debugger;
                        $scope.vates = response.data;
                    });



                $scope.invoiceNumber = null;
                $scope.posoNumber = null;
                $scope.billTo = null;
                $scope.invoiceDate = null;
                $scope.paymentDue = null;
                $scope.total = null;
                $scope.discount = null;
                $scope.totalTaxableAmount = null;
                $scope.totalVat = null;
                $scope.totalAmountDue = null;

                $scope.SaveAndContinueInvoice = function() {
                    var data = {
                        invoiceNumber: $scope.invoiceNumber,
                        posoNumber: $scope.posoNumber,
                        billTo: $scope.billTo,
                        invoiceDate: $scope.invoiceDate,
                        paymentDue: $scope.paymentDue,
                        total: $scope.total,
                        discount: $scope.discount,
                        totalTaxableAmount: $scope.totalTaxableAmount,
                        totalVat: $scope.totalVat,
                        totalAmountDue: $scope.totalAmountDue
                    };


                    $http.post('http://cd38-2a0a-a540-b1bf-0-ed14-4006-ff2f-4065.ngrok.io/control/saveInvoice', JSON.stringify(data)).then(function(response) {}, function(response) {
                        alert("Invoice Saved successfully...!")
                    });
                };
            });

            //Invoice Main Page
            app.controller("invoiceController", function($scope, $http) {
                $http.get(basePath + "control/getInvoices?companyID=2")
                    .then(function(response) {
                        debugger
                        $scope.invoices = response.data;
                    });

                $http.get(basePath + "control/getAllCustomers?companyID=1")
                    .then(function(response) {
                        $scope.customers = response.data;
                    });

            });

        }());
    </script>

</head>

<body id="body-pd" ng-app="myApp">
    <header class="header" id="header">
        <div class="header_toggle"> <i class='bx bx-menu' id="header-toggle"></i> </div>
        <div class="header_img"> <img ng-src="#!https://i.imgur.com/hczKIze.jpg" alt=""> </div>
    </header>
    <div class="l-navbar" id="nav-bar">
        <nav class="nav">
            <div>
                <a ng-href="#!main" class="nav_logo"> <i class='bx bx-layer nav_logo-icon'></i> <span class="nav_logo-name">BBBootstrap</span> </a>
                <div class="nav_list">
                    <a ng-href="#!main" class="nav_link active"> <i class='bx bx-grid-alt nav_icon'></i> <span class="nav_name">Dashboard</span> </a>
                    <a ng-href="#!products" class="nav_link"> <i class='bx bx-box nav_icon'></i> <span class="nav_name">Product</span> </a>
                    <a ng-href="#!customer" class="nav_link"> <i class='bx bx-user nav_icon'></i> <span class="nav_name">Customer</span> </a>
                    <a ng-href="/#!invoice" class="nav_link"> <i class="fas fa-file-invoice"></i> <span class="nav_name">Invoice</span> </a>
                    <a ng-href="/#!report" class="nav_link"> <i class="fas fa-chart-bar"></i> <span class="nav_name">Invoice</span> </a>
                    <a ng-href="/#!setting" class="nav_link"> <i class="fas fa-cog nav_icon"></i></i> <span class="nav_name">Settings</span> </a>
                </div>
            </div>
            <a href="#!" class="nav_link"> <i class='bx bx-log-out nav_icon'></i> <span class="nav_name">SignOut</span>
            </a>
        </nav>
    </div>
    <div ng-view></div>
    <!--Container Main start-->
</body>

</html>