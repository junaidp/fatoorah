<!DOCTYPE html>
<html lang="en">

<head>
    <title>Login V1</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--===============================================================================================-->
    <link rel="icon" type="image/png" href="images/icons/favicon.ico" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <!--===============================================================================================-->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
</head>

<body ng-app="userApp" ng-controller="userCtrl">
    <div class="limiter">
        <div class="container-login100">
            <div class="wrap-login100">
                <div class="login100-pic js-tilt" data-tilt>
                    <img src="images/Logo_GoFatoora_v1-03.png" style="width: 300px;" alt="IMG">
                </div>

                <form class="login100-form validate-form">
                    <span class="login100-form-title">
						Member Login
					</span>

                    <div class="wrap-input100 validate-input" data-validate="Valid email is required: ex@abc.xyz">
                        <input class="input100" type="text" name="email" placeholder="Email" ng-model="user">
                        <span class="focus-input100"></span>
                        <span class="symbol-input100">
							<i class="fa fa-envelope" aria-hidden="true"></i>
						</span>
                    </div>

                    <div class="wrap-input100 validate-input" data-validate="Password is required">
                        <input class="input100" type="password" name="pass" placeholder="Password" ng-model="password">
                        <span class="focus-input100"></span>
                        <span class="symbol-input100">
							<i class="fa fa-lock" aria-hidden="true"></i>
						</span>
                    </div>

                    <div class="container-login100-form-btn">
                        <button class="login100-form-btn" type="button" ng-click="signInUser()">
							Login
						</button>
                    </div>

                    <!--<div class="text-center p-t-12">
						<span class="txt1">
							Forgot
						</span>
						<a class="txt2" href="#">
							Username / Password?
						</a>
					</div>-->

                    <div class="text-center p-t-136">
                        <a class="txt2" href="/loginregisterform/registration.html">
							Create your Account
							<i class="fa fa-long-arrow-right m-l-5" aria-hidden="true"></i>
						</a>
                    </div>
                </form>
            </div>
        </div>
    </div>




    <!--===============================================================================================-->
    <script src="vendor/jquery/jquery-3.2.1.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/bootstrap/js/popper.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/select2/select2.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/tilt/tilt.jquery.min.js"></script>
    <script src="js/notify.min.js"></script>
    <script>
        $('.js-tilt').tilt({
            scale: 1.1
        })
    </script>
    <!--===============================================================================================-->
    <script src="js/main.js"></script>
    <script>
        var app = angular.module("userApp", []);
        var basePath = "https://einvoice-1634502460189.azurewebsites.net/";
        app.controller("userCtrl", function($scope, $http) {

            $scope.user = null;
            $scope.password = null;


            $scope.signInUser = function() {
                var data = {
                    'email': $scope.user,
                    'password': $scope.password
                }
                debugger;
                $http.post(basePath + 'control/signIn', JSON.stringify(data), {
                        headers: {
                            'Content-Type': 'application/json',
                            'Accept': '*/*'
                        }
                    }

                ).then(function(response) {
                        debugger;
                        if (response.data.length == 1) {
                            sessionStorage.setItem('company_id', response.data[0].companyID);
                            sessionStorage.setItem('id', response.data[0].id);

                            sessionStorage.setItem('address1', response.data[0].address1);
                            sessionStorage.setItem('address2', response.data[0].address2);
                            sessionStorage.setItem('cellNo', response.data[0].cellNo);
                            sessionStorage.setItem('firstName', response.data[0].firstName);
                            sessionStorage.setItem('lastName', response.data[0].lastName);
                            sessionStorage.setItem('city', response.data[0].city);
                            sessionStorage.setItem('companyName', response.data[0].companyName);
                            sessionStorage.setItem('country', response.data[0].country);
                            sessionStorage.setItem('currency', response.data[0].currency);
                            sessionStorage.setItem('email', response.data[0].email);
                            //sessionStorage.setItem('id', response.data.id);
                            sessionStorage.setItem('notes', response.data[0].notes);
                            sessionStorage.setItem('password', response.data[0].password);
                            sessionStorage.setItem('postalCode', response.data[0].postalCode);
                            sessionStorage.setItem('state', response.data[0].state);
                            sessionStorage.setItem('userType', response.data[0].userType);
                            sessionStorage.setItem('logo', response.data.logo);
                            sessionStorage.setItem('website', response.data[0].website);
                            debugger;
                            sessionStorage.setItem('vatNumber_Company', response.data[0].otherSellerid_Company);
                            sessionStorage.setItem('additionalNumber_Company', response.data[0].additionalNumber_Company);
                            sessionStorage.setItem('otherSellerid_Company', response.data[0].otherSellerid_Company);

                            //Set For user
                            sessionStorage.setItem('approve', response.data[0].approve);
                            sessionStorage.setItem('productSetup', response.data[0].productSetup);
                            sessionStorage.setItem('invoiceRaise', response.data[0].invoiceRaise);
                            sessionStorage.setItem('paymentReceipt', response.data[0].paymentReceipt);

                            window.location.href = "/#!/";

                        } else if (response.data.length == 2) {

                            sessionStorage.setItem('company_id', response.data[0].companyID);
                            sessionStorage.setItem('id', response.data[0].id);

                            sessionStorage.setItem('address1', response.data[0].address1);
                            sessionStorage.setItem('address2', response.data[0].address2);
                            sessionStorage.setItem('cellNo', response.data[0].cellNo);
                            sessionStorage.setItem('firstName', response.data[0].firstName);
                            sessionStorage.setItem('lastName', response.data[0].lastName);
                            sessionStorage.setItem('city', response.data[0].city);
                            sessionStorage.setItem('companyName', response.data[0].companyName);
                            sessionStorage.setItem('country', response.data[0].country);
                            sessionStorage.setItem('currency', response.data[0].currency);
                            sessionStorage.setItem('email', response.data[0].email);
                            //sessionStorage.setItem('id', response.data.id);
                            sessionStorage.setItem('notes', response.data[0].notes);
                            sessionStorage.setItem('password', response.data[0].password);
                            sessionStorage.setItem('postalCode', response.data[0].postalCode);
                            sessionStorage.setItem('state', response.data[0].state);
                            sessionStorage.setItem('userType', response.data[0].userType);
                            sessionStorage.setItem('logo', response.data.logo);
                            sessionStorage.setItem('website', response.data[0].website);
                            debugger;
                            sessionStorage.setItem('vatNumber_Company', response.data[0].otherSellerid_Company);
                            sessionStorage.setItem('additionalNumber_Company', response.data[0].additionalNumber_Company);
                            sessionStorage.setItem('otherSellerid_Company', response.data[0].otherSellerid_Company);

                            //Set For user
                            sessionStorage.setItem('approve', response.data[0].approve);
                            sessionStorage.setItem('productSetup', response.data[0].productSetup);
                            sessionStorage.setItem('invoiceRaise', response.data[0].invoiceRaise);
                            sessionStorage.setItem('paymentReceipt', response.data[0].paymentReceipt);

                            //arabic section
                            sessionStorage.setItem('address1Arabic', response.data[1].address1);
                            sessionStorage.setItem('address2Arabic', response.data[1].address2);
                            sessionStorage.setItem('firstNameArabic', response.data[1].firstName);
                            sessionStorage.setItem('lastNameArabic', response.data[1].lastName);
                            sessionStorage.setItem('cityarAbic', response.data[1].city);
                            sessionStorage.setItem('companyNameArabic', response.data[1].companyName);
                            sessionStorage.setItem('countryArabic', response.data[1].country);
                            sessionStorage.setItem('notesArabic', response.data[1].notes);
                            sessionStorage.setItem('stateArabic', response.data[1].state);
                            sessionStorage.setItem('postalCodeArabic', response.data[1].postalCode);

                            window.location.href = "/#!/";

                        } else if (response.data == '"Invalid Credentials"') {
                            $.notify(response.data, "error");
                            return;
                        }
                    },
                    function(response) {
                        debugger;
                        sessionStorage.setItem('company_id', response.data.companyID);
                        window.location.href = "/#!/";
                    });
            };
        });
    </script>
</body>

</html>